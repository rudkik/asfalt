<?xml version="1.0"?>
<?mso-application progid="Excel.Sheet"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:o="urn:schemas-microsoft-com:office:office"
 xmlns:x="urn:schemas-microsoft-com:office:excel"
 xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:html="http://www.w3.org/TR/REC-html40">
 <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">
  <Author>Kuk</Author>
  <Description>Created with Fast Reports Inc.</Description>
  <LastAuthor>Admin</LastAuthor>
  <Revision>1</Revision>
  <LastPrinted>2019-05-08T08:12:57Z</LastPrinted>
  <Created>2018-03-30T13:26:44Z</Created>
  <LastSaved>2019-05-08T06:46:25Z</LastSaved>
  <Version>12.00</Version>
 </DocumentProperties>
 <OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office">
  <AllowPNG/>
 </OfficeDocumentSettings>
 <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">
  <WindowHeight>8190</WindowHeight>
  <WindowWidth>15600</WindowWidth>
  <WindowTopX>0</WindowTopX>
  <WindowTopY>0</WindowTopY>
  <TabRatio>400</TabRatio>
  <ProtectStructure>False</ProtectStructure>
  <ProtectWindows>False</ProtectWindows>
 </ExcelWorkbook>
 <Styles>
  <Style ss:ID="Default" ss:Name="Normal">
   <Alignment ss:Horizontal="Left" ss:Vertical="Top" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="9"
    ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
   <Protection/>
  </Style>
  <Style ss:ID="s39" ss:Name="20% - Акцент1">
   <Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#000000"/>
   <Interior ss:Color="#DBE5F1" ss:Pattern="Solid"/>
  </Style>
  <Style ss:ID="s62">
   <Alignment ss:Horizontal="Left" ss:Vertical="Top" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="9"
    ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
   <Protection/>
  </Style>
  <Style ss:ID="s116">
   <Alignment ss:Horizontal="Center" ss:Vertical="Top" ss:WrapText="1"/>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="14"
    ss:Bold="1"/>
  </Style>
  <Style ss:ID="s120">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Italic="1"/>
  </Style>
  <Style ss:ID="s190">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="9"/>
   <NumberFormat ss:Format="#,##0"/>
  </Style>
  <Style ss:ID="s200">
   <Alignment ss:Horizontal="Right" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="9"
    ss:Color="#000000"/>
   <Interior/>
   <NumberFormat ss:Format="#,##0"/>
   <Protection/>
  </Style>
  <Style ss:ID="s201">
   <Alignment ss:Horizontal="Right" ss:Vertical="Top" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="9"
    ss:Bold="1"/>
   <NumberFormat ss:Format="#,##0"/>
  </Style>
  <Style ss:ID="s202">
   <Alignment ss:Horizontal="Right" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="9"
    ss:Color="#000000"/>
   <Interior/>
   <NumberFormat ss:Format="#,##0.00"/>
   <Protection/>
  </Style>
  <Style ss:ID="s203">
   <Alignment ss:Horizontal="Right" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="9"
    ss:Color="#000000"/>
   <Interior/>
   <NumberFormat ss:Format="#,##0"/>
   <Protection/>
  </Style>
  <Style ss:ID="s204">
   <Alignment ss:Horizontal="Right" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="9"
    ss:Color="#000000" ss:Bold="1"/>
   <Interior/>
   <NumberFormat ss:Format="#,##0.00"/>
   <Protection/>
  </Style>
  <Style ss:ID="s205">
   <Alignment ss:Horizontal="Right" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="9"
    ss:Color="#000000" ss:Bold="1"/>
   <Interior/>
   <NumberFormat ss:Format="#,##0"/>
   <Protection/>
  </Style>
  <Style ss:ID="s209">
   <Alignment ss:Horizontal="Left" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="9"/>
   <NumberFormat ss:Format="h:mm;@"/>
  </Style>
  <Style ss:ID="s210">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="9"
    ss:Color="#000000"/>
   <NumberFormat/>
  </Style>
  <Style ss:ID="s211">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="9"
    ss:Color="#000000" ss:Bold="1"/>
   <NumberFormat/>
  </Style>
  <Style ss:ID="s213">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="10"
    ss:Bold="1"/>
  </Style>
  <Style ss:ID="s214">
   <Alignment ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Bold="1"/>
  </Style>
  <Style ss:ID="s215">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Bold="1"/>
  </Style>
  <Style ss:ID="s221" ss:Parent="s39">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Color="#000000" ss:Bold="1"/>
  </Style>
 </Styles>
 <Worksheet ss:Name="Лист1">
 <?php
 $rows = 0;
 foreach ($ballasts['data'] as $driver){
     $rows += count($driver['data']) + 1;
 }
 ?>
  <Table ss:ExpandedColumnCount="<?php echo count($distances['data']) * 3 + 13; ?>" ss:ExpandedRowCount="<?php echo $rows + 12; ?>" x:FullColumns="1"
   x:FullRows="1" ss:DefaultColumnWidth="60">
   <Column ss:StyleID="s62" ss:Width="24"/>
   <Column ss:StyleID="s62" ss:Width="39"/>
   <Column ss:StyleID="s62" ss:Width="85.5"/>
   <?php foreach ($distances['data'] as $distance){ ?>
   <Column ss:Width="36"/>
   <Column ss:Width="49.5"/>
   <Column ss:Width="68.25"/>
   <?php } ?>
   <Column ss:AutoFitWidth="0" ss:Width="67.5"/>
   <Column ss:Width="28.5"/>
   <Column ss:Width="36"/>
   <Column ss:Width="68.25"/>
   <Column ss:Width="24"/>
   <Column ss:Width="32.25"/>
   <Column ss:Width="28.5"/>
   <Row ss:AutoFitHeight="0" ss:Height="28.75">
    <Cell ss:MergeAcross="<?php echo count($distances['data']) * 3 + 9; ?>" ss:StyleID="s116"><Data ss:Type="String">Реестр начисления заработной платы водителям (рейсы сдельно) <?php echo htmlspecialchars($branch, ENT_XML1); ?></Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="1">
    <Cell ss:MergeAcross="<?php echo count($distances['data']) * 3 + 9; ?>" ss:StyleID="s120"><Data ss:Type="String">Отчет за период: с <?php echo Helpers_DateTime::getDateTimeRusWithoutSeconds($dateFrom); ?> до <?php echo Helpers_DateTime::getDateTimeRusWithoutSeconds($dateTo); ?></Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="13.5"/>
   <Row ss:Height="30">
    <Cell ss:MergeAcross="1" ss:StyleID="s213"><Data ss:Type="String">Отраб. дни</Data></Cell>
    <Cell ss:MergeDown="1" ss:StyleID="s213"><Data ss:Type="String">ФИО</Data></Cell>
    <?php foreach ($distances['data'] as $distance){ ?>
    <Cell ss:MergeAcross="2" ss:StyleID="s213"><Data ss:Type="String"><?php echo htmlspecialchars($distance['name'], ENT_XML1); ?></Data></Cell>
    <?php } ?>
    <Cell ss:MergeDown="1" ss:StyleID="s213"><Data ss:Type="String">Начислено з/п всего</Data></Cell>
    <Cell ss:MergeAcross="2" ss:StyleID="s213"><Data ss:Type="String">Празничные</Data></Cell>
    <Cell ss:MergeAcross="1" ss:StyleID="s213"><Data ss:Type="String">Ремонт</Data></Cell>
    <Cell ss:MergeDown="1" ss:StyleID="s213"><Data ss:Type="String">Ночь</Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="1">
    <Cell ss:StyleID="s214"><Data ss:Type="String">таб.</Data></Cell>
    <Cell ss:StyleID="s214"><Data ss:Type="String">ин.под</Data></Cell>
    <?php $i = 1; foreach ($distances['data'] as $distance){ ?>
    <Cell <?php if($i++ == 1){?>ss:Index="4" <?php } ?>ss:StyleID="s215"><Data ss:Type="String">рейсы</Data></Cell>
    <Cell ss:StyleID="s215"><Data ss:Type="String">расценка</Data></Cell>
    <Cell ss:StyleID="s215"><Data ss:Type="String">сумма</Data></Cell>
    <?php } ?>
    <Cell ss:Index="<?php echo count($distances['data']) * 3 + 5; ?>" ss:StyleID="s215"><Data ss:Type="String">часы</Data></Cell>
    <Cell ss:StyleID="s215"><Data ss:Type="String">рейсы</Data></Cell>
    <Cell ss:StyleID="s215"><Data ss:Type="String">сумма</Data></Cell>
    <Cell ss:StyleID="s215"><Data ss:Type="String">дни</Data></Cell>
    <Cell ss:StyleID="s215"><Data ss:Type="String">часы</Data></Cell>
   </Row>
   <?php foreach ($ballasts['data'] as $driver){ ?>
   <?php foreach ($driver['data'] as $distanceIndex){ ?>
   <Row ss:AutoFitHeight="1">
    <Cell ss:StyleID="s210"><Data ss:Type="Number"></Data></Cell>
    <Cell ss:StyleID="s210"><Data ss:Type="Number"><?php echo $driver['work_day']; ?></Data></Cell>
    <Cell ss:StyleID="s209"><Data ss:Type="String"><?php echo htmlspecialchars($driver['name'], ENT_XML1); ?></Data></Cell>
    <?php foreach ($distances['data'] as $distance){ ?>
    <Cell ss:StyleID="s200"><?php $count = Arr::path($distanceIndex['data'], $distance['id'].'.count', 0); if ($count > 0){?><Data ss:Type="Number"><?php echo $count; ?></Data><?php }?></Cell>
    <Cell ss:StyleID="s202"><?php $tariff = Arr::path($distanceIndex['data'], $distance['id'].'.tariff', 0); if ($tariff > 0){?><Data ss:Type="Number"><?php echo $tariff; ?></Data><?php }?></Cell>
    <Cell ss:StyleID="s202"><?php $amount = Arr::path($distanceIndex['data'], $distance['id'].'.amount', 0); if ($amount > 0){?><Data ss:Type="Number"><?php echo $amount; ?></Data><?php }?></Cell>
    <?php } ?>
    <Cell ss:StyleID="s202"><Data ss:Type="Number"><?php echo $driver['amount']; ?></Data></Cell>
    <Cell ss:StyleID="s203"><?php if ($driver['holiday']['hour'] > 0){?><Data ss:Type="Number"><?php echo $driver['holiday']['hour']; ?></Data><?php }?></Cell>
    <Cell ss:StyleID="s203"><?php if ($driver['holiday']['count'] > 0){?><Data ss:Type="Number"><?php echo $driver['holiday']['count']; ?></Data><?php }?></Cell>
    <Cell ss:StyleID="s202"><?php if ($driver['holiday']['amount'] > 0){?><Data ss:Type="Number"><?php echo $driver['holiday']['amount']; ?></Data><?php }?></Cell>
    <Cell ss:StyleID="s203"><Data ss:Type="Number"></Data></Cell>
    <Cell ss:StyleID="s203"><Data ss:Type="Number"></Data></Cell>
    <Cell ss:StyleID="s203"><Data ss:Type="Number"><?php echo $driver['night_hour']; ?></Data></Cell>
   </Row>
   <?php  } ?>
   <?php  } ?>
   <Row ss:AutoFitHeight="0">
    <Cell ss:StyleID="s211"><Data ss:Type="Number"></Data></Cell>
    <Cell ss:StyleID="s211"><Data ss:Type="Number"><?php echo $ballasts['work_day']; ?></Data></Cell>
    <Cell ss:StyleID="s190"><Data ss:Type="String">х</Data></Cell>
    <?php $amount = 0; foreach ($distances['data'] as $distance){ ?>
    <Cell ss:StyleID="s201"><Data ss:Type="Number"><?php echo $distance['count']; ?></Data></Cell>
    <Cell ss:StyleID="s190"><Data ss:Type="String">х</Data></Cell>
    <Cell ss:StyleID="s204"><Data ss:Type="Number"><?php echo $distance['amount']; ?></Data></Cell>
    <?php } ?>
    <Cell ss:StyleID="s204"><Data ss:Type="Number"><?php echo $ballasts['amount']; ?></Data></Cell>
    <Cell ss:StyleID="s204"><Data ss:Type="Number"><?php echo $ballasts['holiday']['hour']; ?></Data></Cell>
    <Cell ss:StyleID="s205"><Data ss:Type="Number"><?php echo $ballasts['holiday']['count']; ?></Data></Cell>
    <Cell ss:StyleID="s204"><Data ss:Type="Number"><?php echo $ballasts['holiday']['amount']; ?></Data></Cell>
    <Cell ss:StyleID="s205"><Data ss:Type="Number"></Data></Cell>
    <Cell ss:StyleID="s205"><Data ss:Type="Number"></Data></Cell>
    <Cell ss:StyleID="s205"><Data ss:Type="Number"><?php echo $ballasts['night_hour']; ?></Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="16.5"/>
   <Row ss:AutoFitHeight="0">
    <Cell ss:MergeAcross="9"><ss:Data ss:Type="String" xmlns="http://www.w3.org/TR/REC-html40"><Font
     html:Color="#000000">Сформирован:</Font><B><Font html:Color="#000000"> <?php echo date('d.m.Y H:i'); ?></Font></B></ss:Data></Cell>
   </Row>
  </Table>
  <WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">
   <PageSetup>
    <Layout x:Orientation="Landscape"/>
    <Header x:Margin="0.3"/>
    <Footer x:Margin="0.3"/>
       <PageMargins x:Bottom="0.75" x:Left="0.25" x:Right="0.25" x:Top="0.75"/>
   </PageSetup>
   <Unsynced/>
   <Print>
    <ValidPrinterInfo/>
    <PaperSizeIndex>9</PaperSizeIndex>
    <HorizontalResolution>600</HorizontalResolution>
    <VerticalResolution>600</VerticalResolution>
   </Print>
   <Selected/>
   <Panes>
    <Pane>
     <Number>3</Number>
     <ActiveRow>11</ActiveRow>
     <RangeSelection>R12C1:R12C10</RangeSelection>
    </Pane>
   </Panes>
   <ProtectObjects>False</ProtectObjects>
   <ProtectScenarios>False</ProtectScenarios>
  </WorksheetOptions>
 </Worksheet>
</Workbook>