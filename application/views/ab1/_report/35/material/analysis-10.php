<?xml version="1.0"?>
<?mso-application progid="Excel.Sheet"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:o="urn:schemas-microsoft-com:office:office"
 xmlns:x="urn:schemas-microsoft-com:office:excel"
 xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:html="http://www.w3.org/TR/REC-html40">
 <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">
  <Author>Kuk</Author>
  <LastAuthor>Kuk</LastAuthor>
  <LastPrinted>2019-08-29T04:31:28Z</LastPrinted>
  <Created>2019-08-23T09:45:56Z</Created>
  <LastSaved>2019-08-29T04:39:46Z</LastSaved>
  <Version>16.00</Version>
 </DocumentProperties>
 <OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office">
  <AllowPNG/>
 </OfficeDocumentSettings>
 <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">
  <WindowHeight>8295</WindowHeight>
  <WindowWidth>24000</WindowWidth>
  <WindowTopX>32767</WindowTopX>
  <WindowTopY>32767</WindowTopY>
  <RefModeR1C1/>
  <ProtectStructure>False</ProtectStructure>
  <ProtectWindows>False</ProtectWindows>
 </ExcelWorkbook>
 <Styles>
  <Style ss:ID="Default" ss:Name="Normal">
   <Alignment ss:Vertical="Bottom"/>
   <Borders/>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
   <Protection/>
  </Style>
  <Style ss:ID="s40" ss:Name="40% — акцент1">
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Color="#000000"/>
   <Interior ss:Color="#B4C6E7" ss:Pattern="Solid"/>
  </Style>
  <Style ss:ID="s62">
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Color="#000000"/>
  </Style>
  <Style ss:ID="s96">
   <Alignment ss:Horizontal="Left" ss:Vertical="Bottom"/>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Color="#000000"/>
  </Style>
  <Style ss:ID="s108">
   <Alignment ss:Horizontal="Right" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Color="#000000" ss:Bold="1"/>
  </Style>
  <Style ss:ID="s115">
   <NumberFormat ss:Format="Standard"/>
   <Alignment ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Color="#000000"/>
  </Style>
  <Style ss:ID="s116">
   <NumberFormat ss:Format="Standard"/>
   <Alignment ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Color="#000000" ss:Bold="1"/>
  </Style>
  <Style ss:ID="m115">
   <NumberFormat ss:Format="0"/>
   <Alignment ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Color="#000000"/>
  </Style>
  <Style ss:ID="m116">
   <NumberFormat ss:Format="0"/>
   <Alignment ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Color="#000000" ss:Bold="1"/>
  </Style>
  <Style ss:ID="s134" ss:Parent="s40">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Color="#000000" ss:Bold="1"/>
  </Style>
  <Style ss:ID="s136" ss:Parent="s40">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Color="#000000"
    ss:Bold="1"/>
  </Style>
  <Style ss:ID="s137" ss:Parent="s40">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Color="#000000"
    ss:Bold="1"/>
   <NumberFormat ss:Format="dd/mm/yy;@"/>
  </Style>
  <Style ss:ID="s140">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"
    ss:Color="#000000" ss:Bold="1"/>
  </Style>
  <Style ss:ID="s143">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Color="#000000"/>
  </Style>
  <Style ss:ID="s145">
   <Alignment ss:Horizontal="Left" ss:Vertical="Bottom" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Color="#000000"/>
  </Style>
  <Style ss:ID="s146">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Color="#000000"/>
  </Style>
 </Styles>
<?php
$cols = 0;
$date = $dateFrom;
while (strtotime($date) <= strtotime($dateTo)){
    $date = Helpers_DateTime::plusDays($date, 1);
    $cols += 2;
}
?>
 <Worksheet ss:Name="Лист1">
  <Names>
   <NamedRange ss:Name="Print_Titles" ss:RefersTo="='Лист1'!C1,'Лист1'!R2:R3"/>
  </Names>
  <Table ss:ExpandedColumnCount="<?php echo $cols + 6; ?>" ss:ExpandedRowCount="<?php echo count($cars['data']) + 11; ?>" x:FullColumns="1"
   x:FullRows="1" ss:StyleID="s62" ss:DefaultRowHeight="15">
   <Column ss:StyleID="s62" ss:AutoFitWidth="0" ss:Width="60"/>
   <Column ss:StyleID="s62" ss:AutoFitWidth="0" ss:Width="41" ss:Span="<?php echo $cols - 1; ?>"/>
   <Column ss:StyleID="s62" ss:AutoFitWidth="0" ss:Width="47.25"/>
   <Row ss:AutoFitHeight="0" ss:Height="24.75">
    <Cell ss:MergeAcross="<?php echo $cols + 1; ?>" ss:StyleID="s140"><Data ss:Type="String">Завоз материалов с <?php echo Helpers_DateTime::getDateFormatRus($dateFrom); ?> по <?php echo Helpers_DateTime::getDateFormatRus($dateTo); ?></Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="22.5">
    <Cell ss:MergeDown="1" ss:StyleID="s136"><Data ss:Type="String">№ авто</Data></Cell>
    <?php
    $date = $dateFrom;
    while (strtotime($date) <= strtotime($dateTo)){
        ?>
    <Cell ss:MergeAcross="1" ss:StyleID="s137"><Data ss:Type="DateTime"><?php echo Helpers_DateTime::getDateFormatPHP($date); ?></Data></Cell>
    <?php
        $date = Helpers_DateTime::plusDays($date, 1);
    }
    ?>
    <Cell ss:MergeAcross="1" ss:StyleID="s134"><Data ss:Type="String">Итого</Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="22.5">
    <?php
    $i = 0;
    $date = $dateFrom;
    while (strtotime($date) <= strtotime($dateTo)){
        ?>
    <Cell <?php if($i == 0){ ?>ss:Index="2"<?php  $i++;} ?> ss:StyleID="s137"><Data ss:Type="String">Рейс</Data></Cell>
    <Cell ss:StyleID="s137"><Data ss:Type="String">Кол-во</Data></Cell>
    <?php
        $date = Helpers_DateTime::plusDays($date, 1);
    }
    ?>
    <Cell ss:StyleID="s137"><Data ss:Type="String">Рейс</Data></Cell>
    <Cell ss:StyleID="s137"><Data ss:Type="String">Кол-во</Data></Cell>
   </Row>
   <?php foreach ($cars['data'] as $car){?>
   <Row ss:AutoFitHeight="0">
    <Cell ss:StyleID="s115"><Data ss:Type="String"><?php echo htmlspecialchars($car['name'], ENT_XML1); ?></Data></Cell>
    <?php
    $date = $dateFrom;
    while (strtotime($date) <= strtotime($dateTo)){
        $data = Arr::path($car['dates'], $date, array('quantity' => '', 'count' => ''));
    ?>
    <Cell ss:StyleID="m115"><?php if($data['count'] > 0){?><Data ss:Type="Number"><?php echo $data['count']; ?></Data><?php }?></Cell>
    <Cell ss:StyleID="s115"><?php if($data['quantity'] > 0){?><Data ss:Type="Number"><?php echo $data['quantity']; ?></Data><?php }?></Cell>
    <?php
        $date = Helpers_DateTime::getDateFormatPHP(Helpers_DateTime::plusDays($date, 1));
    }
    ?>
    <Cell ss:StyleID="s116"><Data ss:Type="Number"><?php echo $car['count']; ?></Data></Cell>
    <Cell ss:StyleID="s116"><Data ss:Type="Number"><?php echo $car['quantity']; ?></Data></Cell>
   </Row>
   <?php } ?>
   <Row ss:AutoFitHeight="0">
    <Cell ss:StyleID="s108"><Data ss:Type="String">Итого</Data></Cell>
    <?php
    $date = $dateFrom;
    while (strtotime($date) <= strtotime($dateTo)){
        $data = Arr::path($cars['dates'], $date, array('quantity' => '', 'count' => ''));
    ?>
    <Cell ss:StyleID="m116"><?php if($data['count'] > 0){?><Data ss:Type="Number"><?php echo $data['count']; ?></Data><?php }?></Cell>
    <Cell ss:StyleID="s116"><?php if($data['quantity'] > 0){?><Data ss:Type="Number"><?php echo $data['quantity']; ?></Data><?php }?></Cell>
    <?php
        $date = Helpers_DateTime::getDateFormatPHP(Helpers_DateTime::plusDays($date, 1));
    }
    ?>
    <Cell ss:StyleID="s116"><Data ss:Type="Number"><?php echo $cars['count']; ?></Data></Cell>
    <Cell ss:StyleID="s116"><Data ss:Type="Number"><?php echo $cars['quantity']; ?></Data></Cell>
   </Row>
   <Row/>
   <Row ss:AutoFitHeight="0">
    <Cell ss:MergeAcross="1" ss:StyleID="s96"><Data ss:Type="String">Подписанты:</Data></Cell>
   </Row>
  </Table>
  <WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">
  <PageSetup>
    <Header x:Margin="0.3"
     x:Data="&amp;L<?php echo htmlspecialchars($shop, ENT_XML1); ?>&amp;CАнализ работы грузоперевозок за 10 дней&#10;&amp;RАТЦ &#10;стр. &amp;P из &amp;N"/>
    <Footer x:Margin="0.3"/>
    <PageMargins x:Bottom="0.75" x:Left="0.25" x:Right="0.25" x:Top="0.75"/>
   </PageSetup>
   <Unsynced/>
   <Print>
    <ValidPrinterInfo/>
    <PaperSizeIndex>9</PaperSizeIndex>
    <HorizontalResolution>600</HorizontalResolution>
    <VerticalResolution>600</VerticalResolution>
   </Print>
      <Selected/>
      <FreezePanes/>
      <FrozenNoSplit/>
      <SplitHorizontal>3</SplitHorizontal>
      <TopRowBottomPane>3</TopRowBottomPane>
      <ActivePane>2</ActivePane>
   <Panes>
    <Pane>
     <Number>3</Number>
     <ActiveRow>3</ActiveRow>
     <ActiveCol>3</ActiveCol>
    </Pane>
   </Panes>
   <ProtectObjects>False</ProtectObjects>
   <ProtectScenarios>False</ProtectScenarios>
  </WorksheetOptions>
 </Worksheet>
</Workbook>