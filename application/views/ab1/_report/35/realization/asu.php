<?xml version="1.0"?>
<?mso-application progid="Excel.Sheet"?>
<Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:o="urn:schemas-microsoft-com:office:office"
 xmlns:x="urn:schemas-microsoft-com:office:excel"
 xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
 xmlns:html="http://www.w3.org/TR/REC-html40">
 <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">
  <Author>Kuk</Author>
  <Description>Created with Fast Reports Inc.</Description>
  <LastAuthor>User</LastAuthor>
  <Revision>1</Revision>
  <LastPrinted>2020-04-30T02:47:51Z</LastPrinted>
  <Created>2018-03-30T13:26:44Z</Created>
  <LastSaved>2020-04-30T02:36:57Z</LastSaved>
  <Version>16.00</Version>
 </DocumentProperties>
 <OfficeDocumentSettings xmlns="urn:schemas-microsoft-com:office:office">
  <AllowPNG/>
 </OfficeDocumentSettings>
 <ExcelWorkbook xmlns="urn:schemas-microsoft-com:office:excel">
  <WindowHeight>8580</WindowHeight>
  <WindowWidth>24000</WindowWidth>
  <WindowTopX>32767</WindowTopX>
  <WindowTopY>32767</WindowTopY>
  <TabRatio>400</TabRatio>
  <ProtectStructure>False</ProtectStructure>
  <ProtectWindows>False</ProtectWindows>
 </ExcelWorkbook>
 <Styles>
  <Style ss:ID="Default" ss:Name="Normal">
   <Alignment ss:Horizontal="Left" ss:Vertical="Top" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Arial" x:CharSet="204" x:Family="Swiss" ss:Size="12"
    ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
   <Protection/>
  </Style>
  <Style ss:ID="m468056552">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"/>
  </Style>
  <Style ss:ID="m468056572">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"/>
  </Style>
  <Style ss:ID="m468056592">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"/>
  </Style>
  <Style ss:ID="m468056612">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"/>
  </Style>
  <Style ss:ID="s62">
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"
    ss:Color="#000000"/>
  </Style>
  <Style ss:ID="s64">
   <Alignment ss:Horizontal="Center" ss:Vertical="Top" ss:WrapText="1"/>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="14"
    ss:Bold="1"/>
  </Style>
  <Style ss:ID="s66">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"
    ss:Italic="1"/>
  </Style>
  <Style ss:ID="s67">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"/>
  </Style>
  <Style ss:ID="s78">
   <Alignment ss:Horizontal="Left" ss:Vertical="Bottom" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss"/>
  </Style>
  <Style ss:ID="d78">
   <Alignment ss:Horizontal="Right" ss:Vertical="Bottom" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss"/>
  </Style>
  <Style ss:ID="s79">
   <Alignment ss:Horizontal="Right" ss:Vertical="Top" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"/>
   <NumberFormat ss:Format="#,##0.000"/>
  </Style>
  <Style ss:ID="s81">
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"
    ss:Bold="1"/>
  </Style>
  <Style ss:ID="s82">
   <Borders/>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"
    ss:Bold="1"/>
  </Style>
  <Style ss:ID="s83">
   <Alignment ss:Horizontal="Right" ss:Vertical="Top" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"
    ss:Bold="1"/>
   <NumberFormat ss:Format="0.000"/>
  </Style>
  <Style ss:ID="s87">
   <Alignment ss:Vertical="Top" ss:WrapText="1"/>
   <Borders/>
  </Style>
  <Style ss:ID="s88">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="14"
    ss:Bold="1"/>
  </Style>
  <Style ss:ID="s89">
   <Alignment ss:Horizontal="Left" ss:Vertical="Bottom" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss"/>
  </Style>
  <Style ss:ID="s90">
   <Alignment ss:Horizontal="Right" ss:Vertical="Top" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"
    ss:Bold="1"/>
   <NumberFormat ss:Format="#,##0.000"/>
  </Style>
  <Style ss:ID="s91">
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"
    ss:Bold="1"/>
  </Style>
  <Style ss:ID="s92">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"/>
   <NumberFormat ss:Format="0.000"/>
  </Style>
  <Style ss:ID="s93">
   <Alignment ss:Horizontal="Left" ss:Vertical="Bottom" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss"/>
  </Style>
  <Style ss:ID="s94">
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"
    ss:Color="#000000"/>
  </Style>
  <Style ss:ID="s103">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"
    ss:Bold="1"/>
  </Style>
  <Style ss:ID="s104">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"/>
  </Style>
  <Style ss:ID="s105">
   <Alignment ss:Horizontal="Center" ss:Vertical="Center" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Bold="1"/>
  </Style>
  <Style ss:ID="s106">
   <Alignment ss:Horizontal="Right" ss:Vertical="Top" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"/>
   <NumberFormat ss:Format="#,##0.000"/>
  </Style>
  <Style ss:ID="s107">
   <Alignment ss:Horizontal="Right" ss:Vertical="Top" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Bold="1"/>
   <NumberFormat ss:Format="#,##0.000"/>
  </Style>
  <Style ss:ID="s108">
   <Alignment ss:Horizontal="Right" ss:Vertical="Top" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"/>
   <NumberFormat ss:Format="#,##0.000"/>
  </Style>
  <Style ss:ID="s109">
   <Alignment ss:Horizontal="Right" ss:Vertical="Top" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="11"
    ss:Bold="1"/>
   <NumberFormat ss:Format="#,##0.000"/>
  </Style>
  <Style ss:ID="s114">
   <Alignment ss:Horizontal="Left" ss:Vertical="Top" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1"/>
   </Borders>
   <Font ss:FontName="Calibri" x:CharSet="204" x:Family="Swiss" ss:Size="12"
    ss:Bold="1"/>
  </Style>
 </Styles>
 <Worksheet ss:Name="Сводка по выпуску">
  <Table ss:ExpandedColumnCount="<?php echo count($turnPlaces) + 6; ?>" ss:ExpandedRowCount="<?php echo count($products['data']) + count($makes['data']) + count($turnPlaceStorages['data']) + count($moveStorages['data']) + count($totalStorages['data'])  + 32; ?>" x:FullColumns="1"
   x:FullRows="1" ss:StyleID="s62" ss:DefaultColumnWidth="60">
      <Column ss:StyleID="s62" ss:AutoFitWidth="0" ss:Width="18.5"/>
   <Column ss:StyleID="s62" ss:AutoFitWidth="0" ss:Width="172.5"/>
   <Column ss:StyleID="s62" ss:Width="52.5" ss:Span="2"/>
   <Column ss:Index="6" ss:StyleID="s62" ss:Width="63.75"/>
   <Row ss:AutoFitHeight="0" ss:Height="18.75">
    <Cell ss:MergeAcross="<?php echo count($turnPlaces) + 2; ?>" ss:StyleID="s64"><Data ss:Type="String">СВОДКА ПО ВЫПУСКУ</Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="31.5">
    <Cell ss:MergeAcross="<?php echo count($turnPlaces) + 2; ?>" ss:StyleID="s66"><Data ss:Type="String">Отчет за период: с <?php echo Helpers_DateTime::getDateTimeRusWithoutSeconds(Request_RequestParams::getParamStr('created_at_from')); ?> до <?php echo Helpers_DateTime::getDateTimeRusWithoutSeconds(Request_RequestParams::getParamStr('created_at_to')); ?></Data></Cell>
   </Row>
   <?php if(count($products['data']) > 0) {?>
   <Row ss:AutoFitHeight="0" ss:Height="16.5">
    <Cell ss:MergeDown="1" ss:StyleID="m468056552"><Data ss:Type="String">№</Data></Cell>
    <Cell ss:MergeDown="1" ss:StyleID="m468056552"><Data ss:Type="String">Наименование продукции</Data></Cell>
    <Cell ss:MergeAcross="<?php echo count($turnPlaces); ?>" ss:StyleID="m468056572"><Data ss:Type="String">Место погрузки</Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="1">
    <?php $i=1; foreach ($turnPlaces as $turnPlace){ ?>
    <Cell <?php if($i++ == 1){ ?>ss:Index="3"<?php } ?> ss:StyleID="s104"><Data ss:Type="String"><?php echo $turnPlace['name']; ?></Data></Cell>
    <?php } ?>
    <Cell <?php if (count($products) == 0){ ?> ss:Index="3"<?php } ?> ss:StyleID="s105"><Data ss:Type="String">ИТОГО</Data></Cell>
   </Row>
   <?php $i = 1; foreach ($products['data'] as $product){ ?>
   <Row ss:AutoFitHeight="1">
    <Cell ss:StyleID="d78"><Data ss:Type="Number"><?php echo $i++; ?></Data></Cell>
    <Cell ss:StyleID="s78"><Data ss:Type="String"><?php echo htmlspecialchars($product['name'], ENT_XML1); ?></Data></Cell>
    <?php foreach ($product['data'] as $element){?>
    <?php if(empty(floatval($element['quantity']))){ ?>
    <Cell ss:StyleID="s108"><Data ss:Type="String"></Data></Cell>
    <?php }else{ ?>
    <Cell ss:StyleID="s108"><Data ss:Type="Number"><?php echo $element['quantity']; ?></Data></Cell>
    <?php } ?>
    <?php }  ?>
    <?php if(empty(floatval($product['quantity'] ))){ ?>
    <Cell ss:StyleID="s109"><Data ss:Type="String"></Data></Cell>
    <?php }else{ ?>
    <Cell ss:StyleID="s109" ss:Formula="=SUM(RC[-<?php echo count($turnPlaces); ?>]:RC[-1])"><Data ss:Type="Number"><?php echo $product['quantity']; ?></Data></Cell>
    <?php }  ?>
   </Row>
   <?php } ?>
   <Row ss:AutoFitHeight="0">
    <Cell ss:MergeAcross="1" ss:StyleID="s81"><Data ss:Type="String">Итого</Data></Cell>
    <?php foreach ($turnPlaces as $turnPlace){?>
    <?php if(empty(floatval($turnPlace['quantity'] ))){ ?>
    <Cell ss:StyleID="s109"><Data ss:Type="String"></Data></Cell>
    <?php }else{ ?>
    <Cell ss:StyleID="s109"><Data ss:Type="Number"><?php echo $turnPlace['quantity']; ?></Data></Cell>
    <?php } ?>
    <?php } ?>
    <?php if(empty(floatval($products['quantity']))){ ?>
    <Cell ss:StyleID="s109"><Data ss:Type="String"></Data></Cell>
    <?php }else{ ?>
    <Cell ss:StyleID="s109"><Data ss:Type="Number"><?php echo $products['quantity']; ?></Data></Cell>
    <?php } ?>
   </Row>
   <?php } ?>
   <?php if(count($turnPlaceStorages['data']) > 0) {?>
   <Row ss:AutoFitHeight="0"></Row>
   <Row ss:AutoFitHeight="0">
    <Cell ss:MergeAcross="3" ss:StyleID="s114"><Data ss:Type="String">В том числе на склад:</Data></Cell>
    <Cell ss:StyleID="s83"/>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="30.5">
    <Cell ss:MergeDown="1" ss:StyleID="m468056592"><Data ss:Type="String">№</Data></Cell>
    <Cell ss:MergeDown="1" ss:StyleID="m468056592"><Data ss:Type="String">Наименование продукции</Data></Cell>
    <Cell ss:MergeAcross="<?php echo count($turnPlaceStorages['data'] ); ?>" ss:StyleID="m468056612"><Data ss:Type="String">Место погрузки</Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="30.25">
    <?php $i=1; foreach ($turnPlaceStorages['data']  as $turnPlace){ ?>
      <?php if($i == 1){ ?>
        <Cell ss:Index="3" ss:StyleID="s67"><Data ss:Type="String"><?php echo $turnPlace['name']; ?></Data></Cell>
      <?php $i++; }else{ ?>
        <Cell ss:StyleID="s67"><Data ss:Type="String"><?php echo htmlspecialchars($turnPlace['name'], ENT_XML1); ?></Data></Cell>
      <?php } ?>
    <?php } ?>
    <Cell ss:StyleID="s103"><Data ss:Type="String">ИТОГО</Data></Cell>
   </Row>
      <?php $i= 1; foreach ($makes['data'] as $product){ ?>
          <Row ss:AutoFitHeight="1">
              <Cell ss:StyleID="d78"><Data ss:Type="Number"><?php echo $i++; ?></Data></Cell>
              <Cell ss:StyleID="s89"><Data ss:Type="String"><?php echo htmlspecialchars($product['name'], ENT_XML1); ?></Data></Cell>
              <?php foreach ($product['data'] as $element){?>
                  <?php if(empty(floatval($element['quantity'] ))){ ?>
                      <Cell ss:StyleID="s106"><Data ss:Type="String"></Data></Cell>
                  <?php }else{ ?>
                      <Cell ss:StyleID="s106"><Data ss:Type="Number"><?php echo $element['quantity']; ?></Data></Cell>
                  <?php } ?>
              <?php }  ?>
              <?php if(empty(floatval($product['quantity'] ))){ ?>
                  <Cell ss:StyleID="s107"><Data ss:Type="String"></Data></Cell>
              <?php }else{ ?>
                  <Cell ss:StyleID="s107" ss:Formula="=SUM(RC[-<?php echo count($product['data']); ?>]:RC[-1])"><Data ss:Type="Number"><?php echo $product['quantity']; ?></Data></Cell>
              <?php }  ?>
          </Row>
      <?php } ?>
   <Row ss:AutoFitHeight="0">
    <Cell ss:MergeAcross="1" ss:StyleID="s91"><Data ss:Type="String">Итого</Data></Cell>
       <?php foreach ($turnPlaceStorages['data'] as $turnPlace){?>
           <?php if(empty(floatval($turnPlace['quantity'] ))){ ?>
               <Cell ss:StyleID="s107"><Data ss:Type="String"></Data></Cell>
           <?php }else{ ?>
               <Cell ss:StyleID="s107"><Data ss:Type="Number"><?php echo $turnPlace['quantity']; ?></Data></Cell>
           <?php } ?>
       <?php } ?>
       <?php if(empty(floatval($products['quantity'] ))){ ?>
           <Cell ss:StyleID="s107"><Data ss:Type="String"></Data></Cell>
       <?php }else{ ?>
           <Cell ss:StyleID="s107"><Data ss:Type="Number"><?php echo $turnPlaceStorages['quantity']; ?></Data></Cell>
       <?php } ?>
   </Row>
   <?php } ?>
   <Row ss:AutoFitHeight="0"></Row>
   <Row ss:AutoFitHeight="0">
    <Cell ss:MergeAcross="1" ss:StyleID="s114"><Data ss:Type="String">Остаток на складе:</Data></Cell>
    <Cell ss:StyleID="s83"/>
    <Cell ss:StyleID="s83"/>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="24">
    <Cell ss:StyleID="s67"><Data ss:Type="String">№</Data></Cell>
    <Cell ss:StyleID="s67"><Data ss:Type="String">Наименование продукции</Data></Cell>
    <Cell ss:StyleID="s92"><Data ss:Type="String">Кол-во</Data></Cell>
    <Cell ss:StyleID="s83"/>
    <Cell ss:StyleID="s83"/>
   </Row>
   <?php $i = 1; foreach ($totalStorages['data'] as $product){ if($product['quantity'] <= 0){continue;}?>
   <Row ss:AutoFitHeight="1">
    <Cell ss:StyleID="d78"><Data ss:Type="Number"><?php echo $i++; ?></Data></Cell>
    <Cell ss:StyleID="s78"><Data ss:Type="String"><?php echo htmlspecialchars($product['name'], ENT_XML1); ?></Data></Cell>
    <Cell ss:StyleID="s79"><Data ss:Type="Number"><?php echo $product['quantity']; ?></Data></Cell>
   </Row>
   <?php } ?>
   <?php if(count($moveStorages['data']) > 0){?>
   <Row ss:AutoFitHeight="0"></Row>
   <Row ss:AutoFitHeight="0">
    <Cell ss:MergeAcross="2" ss:StyleID="s114"><Data ss:Type="String">Перемещение:</Data></Cell>
    <Cell ss:StyleID="s83"/>
    <Cell ss:StyleID="s83"/>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="24">
    <Cell ss:StyleID="s67"><Data ss:Type="String">№</Data></Cell>
    <Cell ss:StyleID="s67"><Data ss:Type="String">Наименование продукции</Data></Cell>
    <Cell ss:StyleID="s92"><Data ss:Type="String">На склад</Data></Cell>
    <Cell ss:StyleID="s92"><Data ss:Type="String">Со склада</Data></Cell>
   </Row>
   <?php $i = 1; foreach ($moveStorages['data'] as $product){?>
   <Row ss:AutoFitHeight="1">
    <Cell ss:StyleID="d78"><Data ss:Type="Number"><?php echo $i++; ?></Data></Cell>
    <Cell ss:StyleID="s78"><Data ss:Type="String"><?php echo htmlspecialchars($product['name'], ENT_XML1); ?></Data></Cell>
    <Cell ss:StyleID="s79"><Data ss:Type="Number"><?php echo $product['quantity_in']; ?></Data></Cell>
    <Cell ss:StyleID="s79"><Data ss:Type="Number"><?php echo $product['quantity_out']; ?></Data></Cell>
   </Row>
   <?php } ?>
   <?php } ?>
   <Row ss:AutoFitHeight="0"></Row>
      <Row ss:AutoFitHeight="0">
          <Cell ss:MergeAcross="4"><ss:Data ss:Type="String"
           xmlns="http://www.w3.org/TR/REC-html40"><Font html:Color="#000000">Оператор:</Font><B><Font
           html:Color="#000000"> <?php echo htmlspecialchars($operation['name'], ENT_XML1); ?> </Font></B><Font html:Color="#000000">  _____________</Font></ss:Data></Cell>
      </Row>
   <Row ss:AutoFitHeight="0">
    <Cell ss:MergeAcross="4"><ss:Data ss:Type="String"
      xmlns="http://www.w3.org/TR/REC-html40"><Font html:Color="#000000">Сформирован:</Font><B><Font
        html:Color="#000000"> <?php echo date('d.m.Y H:i'); ?></Font></B></ss:Data></Cell>
   </Row>
  </Table>
  <WorksheetOptions xmlns="urn:schemas-microsoft-com:office:excel">
   <PageSetup>
    <Header x:Margin="0.3"/>
    <Footer x:Margin="0.3"/>
       <PageMargins x:Bottom="0.75" x:Left="0.25" x:Right="0.25" x:Top="0.75"/>
   </PageSetup>
   <Unsynced/>
   <Print>
    <ValidPrinterInfo/>
    <PaperSizeIndex>9</PaperSizeIndex>
    <HorizontalResolution>600</HorizontalResolution>
    <VerticalResolution>600</VerticalResolution>
   </Print>
   <Selected/>
   <Panes>
    <Pane>
     <Number>3</Number>
     <ActiveRow>20</ActiveRow>
     <ActiveCol>4</ActiveCol>
    </Pane>
   </Panes>
   <ProtectObjects>False</ProtectObjects>
   <ProtectScenarios>False</ProtectScenarios>
  </WorksheetOptions>
 </Worksheet>
</Workbook>
